using System;
using UnityEditor;
using UnityEngine.UIElements;

namespace DaimahouGames.Editor.Core
{
    public class ListTypeSelector<T> : Button where T : class
    {
        //============================================================================================================||
        // ※  Variables: --------------------------------------------------------------------------------------------|
        // ---| Exposed State -------------------------------------------------------------------------------------->|
        // ---| Internal State ------------------------------------------------------------------------------------->|
        // ---| Dependencies --------------------------------------------------------------------------------------->|
        // ---| Properties ----------------------------------------------------------------------------------------->|
        // ---| Events --------------------------------------------------------------------------------------------->|
        // ※  Initialization Methods: -------------------------------------------------------------------------------|

        public ListTypeSelector(SerializedProperty propertyList, ListInspector listInspector)
        {
            var typeSelector = new ItemTypeSelector<T>(propertyList, this);
            typeSelector.EventChange += (_, newType) =>
            {
                var instance = Activator.CreateInstance(newType);
                listInspector.InsertItem(propertyList.arraySize, instance);
            };
        }
        
        // ※  Public Methods: ---------------------------------------------------------------------------------------|
        // ※  Virtual Methods: --------------------------------------------------------------------------------------|
        // ※  Private Methods: --------------------------------------------------------------------------------------|
        //============================================================================================================||
    }
}